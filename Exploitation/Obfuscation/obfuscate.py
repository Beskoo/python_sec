from PIL import Image
import zlib

# Ouvrir l'image et extraire sa taille
img = Image.open('image.png')
largeur, hauteur = img.size

# Calcul de la taille maximale du code pouvant être dissimulée dans l'image
taille_max = largeur * hauteur // 8

# Lire et compresser le fichier de code
with open('code.txt', 'rb') as file:
    code = file.read()
    code_compressé = zlib.compress(code)

# Vérifier que la taille compressée du code est inférieure à la taille maximale
if len(code_compressé) <= taille_max:
    # Intégration du code dans l'image (obfuscation)
    img_data = img.tobytes()
    # ... Code pour modifier les pixels de l'image avec les données du code

    # Sauvegarde de l'image modifiée avec le code dissimulé
    img.save('image_with_code.png')
    print("Code has been obfuscated and saved in the image.")
else:
    print("The compressed code size exceeds the maximum allowed size for this image.")
